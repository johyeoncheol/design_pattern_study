# 플라이웨이트 패턴

플라이웨이트 패턴은 객체를 공유하기 위해 구조를 변경하는 패턴입니다. 객체를 공유하면 객체를 재사용할 수 있어 시스템 자원이 절약됩니다.

 

## 메모리 자원
$obj = new 클래스 명;

위와 같이 new 키워드를 통해서 객체를 생성합니다. 이때 시스템 자원을 할당받게 됩니다.


이러한 객체는 동작을 수행하는 메서드와 데이터를 포함하는 프로퍼티로 구성돼 있습니다.


클래스를 설계할 때는 객체가 하나의 책임만 갖도록 합니다. 이를 단일 책임 원칙이라고 합니다.

하나의 객체가 다양한 기능과 책임을 가지면 관리하기가 어려워집니다.

 
재사용할 수 있는 유사한 동작들은 별개의 클래스로 분리하여 상속으로 결합합니다.


플라이웨이트는 가볍다와 무게의 합성어 입니다. 즉, 객체지향에서 가벼운 객체란 메모리를 적게 사용하는 객체를 말합니다. 

중복된 객체를 개별적으로 상속하거나 생성하지 않고 자원을 재사용함으로써 효율을 개선합니다.

 

## 자원 공유
플라이웨이트 패턴은 객체를 공유하기 위한 패턴입니다. 즉, 생성된 객체를 공유하여 재사용하는 방법을 제시합니다.

 

객체를 생성하는 것보다 의존성 주입을 통해서 자원의 낭비를 막을 수 있습니다.


이전 팩토리 패턴에서 학습한 것처럼 직접 객체를 생성하면 효율적으로 관리할 수 없습니다...

따라서 객체 생성을 대신 처리하는 Factory 클래스를 만들어 사용하는 것이 좋습니다.

 

객체를 공유하려면 동일한 객체를 생성해야 합니다. 따라서 싱글턴 패턴과 결합하여 사용하면 됩니다.


플라이웨이트 패턴은 보다 효율적인 공유 객체를 관리하기 위해 별도의 저장소를 갖고 있는데 이를 공유 저장소라고 합니다.


플라이웨이트 패턴은 무분별하게 객체를 생성하지 않고 기존 객체를 참조함으로써 중복을 방지합니다. 이러한 공유 객체를 저장하는 방식을 인스턴스 풀, 레지스트리 패턴이라고도 부릅니다.

 

## 상태 구분

플라이웨이트 패턴에서 객체를 공유합니다. 객체 공유는 본질적 공유와 부가적 공유로 구분합니다.

 
공유되는 객체의 데이터가 변경되면 참조되는 모든 다른 객체에도 영향을 미치는데 이를 사이드 이펙트라고 합니다.


사이드 이펙트 현상없이 안정적으로 객체를 공유하려면 어떤 변경도 없이 객체를 있는 그대로 참조해서 사용해야 합니다. 이러한 상태를 본질적 상태라고 합니다.

 

이와 달리 부가적 상태는 객체를 공유할 때, 상태값에 따라 달라지는 것을 의미합니다.

이와 같은 경우는 객체의 특정 데이터 값을 변경해 참조하는 다른 객체에 영향을 주기 위해서입니다.

 

나비효과라고 불려지는 사이드 이펙트는 소프트웨어 개발 시, 매우 주의해야 하는 문제입니다.

공유되는 객체는 사이드 이펙트 문제에 노출될 확룰이 매우 높습니다.

따라서 공유 객체를 여러 곳에서 참조할 때는 신중하게 판단한 후 적용해야 합니다.

 

대량의 객체를 생성 및 관리할 경우 플라이웨이트 패턴은 매우 유용한 대안이 될 수 있습니다.
